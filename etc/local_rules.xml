<!-- Local rules -->

<!-- Modify it at your will. -->
<!-- Copyright (C) 2015, Wazuh Inc. -->

<!-- Example -->
<group name="local,syslog,sshd,">

  <!--
  Dec 10 01:02:02 host sshd[1234]: Failed none for root from 1.1.1.1 port 1066 ssh2
  -->
  <rule id="100001" level="5">
    <if_sid>5716</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>sshd: authentication failed from IP 1.1.1.1.</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>

</group>

<!-- Vulnerability detector -->
<group name="vulnerability-detector,">
  <rule id="100010" level="0">
    <decoded_as>json</decoded_as>
    <options>no_full_log</options>
    <field name="serpico.vulnerability.cve">\.+</field>
    <description>$(serpico.vulnerability.cve) affects $(serpico.package.name)</description>
  </rule>

  <rule id="100011" level="5">
    <if_sid>100010</if_sid>
    <options>no_full_log</options>
    <field name="serpico.vulnerability.severity">LOW</field>
    <description>$(serpico.vulnerability.cve) affects $(serpico.package.name)</description>
  </rule>

  <rule id="100012" level="7">
    <if_sid>100010</if_sid>
    <options>no_full_log</options>
    <field name="serpico.vulnerability.severity">MEDIUM</field>
    <description>$(serpico.vulnerability.cve) affects $(serpico.package.name)</description>
  </rule>

  <rule id="100013" level="10">
    <if_sid>100010</if_sid>
    <options>no_full_log</options>
    <field name="serpico.vulnerability.severity">HIGH</field>
    <description>$(serpico.vulnerability.cve) affects $(serpico.package.name)</description>
  </rule>

  <rule id="100014" level="13">
    <if_sid>100010</if_sid>
    <options>no_full_log</options>
    <field name="serpico.vulnerability.severity">CRITICAL</field>
    <description>$(serpico.vulnerability.cve) affects $(serpico.package.name)</description>
  </rule>
</group>
